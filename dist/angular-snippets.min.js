/*!
 *  angular-snippets
 *  Version   : 1.0.0
 *  Date      : 2015-06-22
 *  Author    : DEMONTE Jean-Baptiste
 *  Contact   : jbdemonte@gmail.com
 *  Licence   : GPL v3 : http://www.gnu.org/licenses/gpl.html
 */
!function(e){e.module("Snippets",[]).provider("snippets",function(){var t={content:{before:[],after:[]},options:{cls:{missing:"error"},tabs:{},pane:{}}};this.configure=function(n){e.extend(t.options,n)},this.content={before:function(e){t.content.before.push(e)},after:function(e){t.content.after.push(e)}},this.$get=function(){return t}}).directive("repeatDone",["$timeout","$parse",function(e,t){return{restrict:"A",link:function(n,i,s){n.$last&&e(function(){t(s.repeatDone)(n)})}}}]).directive("tabs",["snippets",function(t){return e.extend({restrict:"E",transclude:!0,scope:!0,controller:["$scope",function(t){var n=!0,i=!1,s=t.panes=[];t.select=function(n){e.forEach(s,function(e){e.selected=!1}),n.selected=!0,t.current.snippet=n.snippet},this.addPane=function(r){(r.selected||n||0===r.index&&!i)&&(n=r.disabled,i=r.snippet.selected,t.select(r)),e.isDefined(r.index)?s.splice(r.index,0,r):s.push(r)}}]},t.options.tabs)}]).directive("pane",["snippets",function(t){return e.extend({require:"^tabs",restrict:"E",transclude:!0,scope:{snippet:"=",index:"="},link:function(e,t,n,i){i.addPane(e)}},t.options.pane)}]).directive("snippets",["$templateRequest","$parse","snippets",function(t,n,i){return{restrict:"E",scope:!0,transclude:!0,template:'<tabs><div><pane snippet="item" index="$index" ng-repeat="item in items" repeat-done="prism()"><pre class="code language-{{item.type}}"><code class="code language-{{item.type}}" ng-bind="item.content"></code></pre></pane><div>'+i.content.before.join("")+"<div ng-transclude></div>"+i.content.after.join("")+"</tabs>",controller:["$scope","$element","$attrs",function(s,r,o){var c=n(o.files)(s),p=0,a=[],u={js:"javascript",html:"markup",svg:"markup",xml:"markup",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell"};s.current={},s.prism=function(){e.forEach(r.find("pre"),function(e){Prism.highlightElement(e)})},c&&c.length&&e.forEach(c,function(e){var n=e.replace(/^.*\./,"").toLowerCase(),r={name:e,type:u[n]||n};a.push(r),t((o.path?o.path+"/":"")+e,!0).then(function(e){r.content=e},function(){r.cls=(r.cls||"")+" "+i.options.cls.missing,r.disabled=!0})["finally"](function(){p++,p===c.length&&(s.items=a,s.path=o.path+"/")})})}]}}])}(angular);